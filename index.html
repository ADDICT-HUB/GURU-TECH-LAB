<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Guru Tech Marketing ‚Äî Home</title>
  <link rel="stylesheet" href="style.css" />
  <style>
    /* Small extras for homepage layout (glassy, compact, same look as boosting) */
    .hero {
      max-width:1100px;margin:24px auto;padding:22px;border-radius:14px;
      background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      border:1px solid rgba(255,255,255,0.03);
      box-shadow:0 20px 50px rgba(2,6,23,0.6);
      display:flex;gap:20px;align-items:center;justify-content:space-between;
      backdrop-filter: blur(6px);
    }

    .hero .intro {
      max-width:58%;
    }
    .hero h1 { margin:0;color:var(--accent);font-size:28px }
    .hero p { margin:8px 0 0; color:var(--muted) }

    .cards-compact {
      display:grid; grid-template-columns:repeat(2,minmax(220px,1fr)); gap:18px; width:38%;
    }

    .card-compact {
      padding:14px;border-radius:12px; display:flex;flex-direction:column;gap:10px;justify-content:space-between;
      background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      border:1px solid rgba(255,255,255,0.03); box-shadow: 0 12px 30px rgba(0,0,0,0.45);
    }

    .card-compact .title { font-weight:800;color:#fff }
    .card-compact .price { font-weight:900;color:var(--accent); font-size:18px; margin-top:4px; }

    /* country selector */
    .price-controls { margin-top:12px; display:flex;gap:8px; align-items:center; flex-wrap:wrap }
    .country-select { padding:8px 10px;border-radius:10px;border:0;background:rgba(255,255,255,0.03);color:#fff;font-weight:700 }

    /* small notice */
    .price-notice { font-size:12px;color:var(--muted); margin-top:8px }

    @media (max-width:900px){
      .hero{flex-direction:column;gap:16px}
      .hero .intro{max-width:100%}
      .cards-compact{width:100%}
    }

  </style>
</head>
<body>

  <!-- decorative glass blobs -->
  <svg class="bg-shape" style="left:-6%;top:6%;width:520px;height:420px;fill:url(#h1);">
    <defs><linearGradient id="h1" x1="0" x2="1"><stop offset="0" stop-color="#ff6a2d"/><stop offset="1" stop-color="#ff3c00"/></linearGradient></defs>
    <filter id="blurh"><feGaussianBlur stdDeviation="40"/></filter>
    <circle cx="260" cy="200" r="170" filter="url(#blurh)"></circle>
  </svg>

  <header class="site-header">
    <div class="brand">
      <div class="logo">GURU TECH LAB</div>
      <div class="subtitle">Guru Tech Marketing</div>
    </div>
    <nav class="top-nav">
      <a href="index.html" class="nav-btn">Home</a>
      <a href="services.html" class="nav-btn">Services</a>
      <a href="boosting.html" class="nav-btn">Boosting</a>
      <a href="pricing.html" class="nav-btn">Pricing</a>
      <a href="contact.html" class="nav-btn">Contact</a>
    </nav>
  </header>

  <!-- MAIN HERO (compact so visible above fold) -->
  <main style="min-height:calc(100vh - 120px);padding:18px;position:relative;z-index:3;">
    <div class="hero" role="region" aria-label="Intro & services">
      <div class="intro">
        <h1>Guru Tech Lab ‚Äî Fast digital services</h1>
        <p>Glassy service cards, balanced prices and country-aware currency conversion. Tap any card to open the full page.</p>

        <div class="price-controls" aria-hidden="false">
          <label for="country-select" style="color:var(--muted);font-weight:700">Prices shown for</label>
          <select id="country-select" class="country-select" aria-label="Select currency country">
            <!-- options will be filled by script; includes 'auto-detect' option -->
            <option value="AUTO">Auto-detect (recommended)</option>
            <option value="KE">Kenya (KSH)</option>
            <option value="NG">Nigeria (NGN)</option>
            <option value="US">United States (USD)</option>
            <option value="GB">United Kingdom (GBP)</option>
            <option value="ZA">South Africa (ZAR)</option>
            <option value="IN">India (INR)</option>
          </select>

          <div id="price-status" class="price-notice" aria-live="polite">Detecting country & rates‚Ä¶</div>
        </div>
      </div>

      <div class="cards-compact" role="list">
        <!-- All cards use data-price-ksh as base price -->
        <a href="boosting.html" class="card-compact" role="listitem">
          <div>
            <div class="title">üöÄ Social Media Boosting</div>
            <div class="service-sub" style="color:var(--muted)">Followers, likes & views across platforms</div>
            <div class="price" data-price-ksh="700">‚Äî</div>
          </div>
          <div style="display:flex;justify-content:flex-end">
            <span class="view-small" style="font-weight:800;color:var(--muted)">View</span>
          </div>
        </a>

        <a href="website.html" class="card-compact" role="listitem">
          <div>
            <div class="title">üíª Website Development</div>
            <div class="service-sub" style="color:var(--muted)">Landing pages, business & e-commerce</div>
            <div class="price" data-price-ksh="1200">‚Äî</div>
          </div>
          <div style="display:flex;justify-content:flex-end"><span class="view-small" style="font-weight:800;color:var(--muted)">View</span></div>
        </a>

        <a href="bots.html" class="card-compact" role="listitem">
          <div>
            <div class="title">ü§ñ Automation & Bots</div>
            <div class="service-sub" style="color:var(--muted)">WhatsApp bots, automations & tools</div>
            <div class="price" data-price-ksh="500">‚Äî</div>
          </div>
          <div style="display:flex;justify-content:flex-end"><span class="view-small" style="font-weight:800;color:var(--muted)">View</span></div>
        </a>

        <a href="branding.html" class="card-compact" role="listitem">
          <div>
            <div class="title">üé® Branding & Digital Setup</div>
            <div class="service-sub" style="color:var(--muted)">Logos, graphics, social kits</div>
            <div class="price" data-price-ksh="300">‚Äî</div>
          </div>
          <div style="display:flex;justify-content:flex-end"><span class="view-small" style="font-weight:800;color:var(--muted)">View</span></div>
        </a>
      </div>
    </div>

    <!-- quick contact row (visible) -->
    <div style="max-width:1100px;margin:18px auto;display:flex;gap:12px;justify-content:center;align-items:center;flex-wrap:wrap">
      <a class="contact-btn whatsapp" href="https://wa.me/254763986398" target="_blank" rel="noopener">üü¢ WhatsApp</a>
      <a class="contact-btn email" href="mailto:akidarajab462@gmail.com">‚úâÔ∏è Email</a>
      <a class="contact-btn instagram" href="https://instagram.com" target="_blank" rel="noopener">üì∏ Instagram</a>
      <button id="music-toggle-hero" class="music-btn" style="margin-left:6px">üîä Play Music</button>
    </div>
  </main>

  <footer class="site-footer">¬© <span id="year"></span> GURU TECH LAB</footer>

  <!-- Hidden audio element: script.js will use it or fallback to WebAudio drone -->
  <audio id="bg-audio" loop preload="auto">
    <source src="assets/ambient.mp3" type="audio/mp3" />
  </audio>

  <!-- Price conversion + country detection script -->
  <script>
    (function(){
      // base currency = KES; we store base prices in data-price-ksh
      const currencySymbols = { KES: 'KSH', NGN: '‚Ç¶', USD: '$', GBP: '¬£', ZAR: 'R', INR: '‚Çπ' };
      const countryToCurrency = {
        KE: 'KES', NG: 'NGN', US: 'USD', GB: 'GBP', ZA: 'ZAR', IN: 'INR'
      };

      const select = document.getElementById('country-select');
      const status = document.getElementById('price-status');
      const priceEls = Array.from(document.querySelectorAll('.price'));
      let rates = null;
      let detectedCountry = null;
      let targetCurrency = 'KES'; // default
      let detecting = true;

      function setPriceDisplays(baseCurrency='KES'){
        // baseCurrency is target currency code
        priceEls.forEach(el => {
          const baseKsh = parseFloat(el.getAttribute('data-price-ksh') || '0');
          if (!rates || baseCurrency === 'KES') {
            // show KES value if no rates loaded or KES selected
            el.textContent = `${baseKsh} ${currencySymbols.KES || 'KSH'}`;
            return;
          }
          // convert using rates: rates is map from KES -> X
          const rate = rates[baseCurrency];
          if (!rate || isNaN(rate)) {
            el.textContent = `${baseKsh} ${currencySymbols.KES || 'KSH'}`; // fallback
            return;
          }
          const converted = Math.round((baseKsh * rate) * 100) / 100;
          // choose symbol
          const sym = currencySymbols[baseCurrency] || baseCurrency + ' ';
          // show with thousands separator
          el.textContent = `${sym} ${numberWithCommas(converted)}`;
        });
      }

      function numberWithCommas(x){
        if (typeof x === 'number') x = x.toString();
        const parts = x.split('.');
        parts[0] = parts[0].replace(/\B(?=(\d{3})+(?!\d))/g, ",");
        return parts.join('.');
      }

      async function fetchRates(){
        // Get exchange rates with base KES using exchangerate.host
        status.textContent = 'Fetching exchange rates‚Ä¶';
        try {
          const res = await fetch('https://api.exchangerate.host/latest?base=KES&symbols=USD,NGN,GBP,ZAR,INR,KES');
          if (!res.ok) throw new Error('Rates fetch failed');
          const data = await res.json();
          rates = data.rates || null;
          // rates is object: { USD: 0.0083, NGN: 36.5, ... } meaning 1 KES = x USD
          status.textContent = 'Prices converted to local currency';
          return true;
        } catch (err) {
          console.warn('Rates error', err);
          status.textContent = 'Currency conversion unavailable ‚Äî showing KSH';
          rates = null;
          return false;
        }
      }

      async function detectCountry(){
        status.textContent = 'Detecting country‚Ä¶';
        try {
          const r = await fetch('https://ipapi.co/json/');
          if (!r.ok) throw new Error('Geo lookup failed');
          const data = await r.json();
          detectedCountry = (data && data.country) || null;
          return detectedCountry;
        } catch (err) {
          console.warn('Geo detect error', err);
          detectedCountry = null;
          return null;
        }
      }

      // If user chooses AUTO, we try detect; else we use chosen country
      async function updatePricingFlow(selected) {
        detecting = true;
        // If user selected AUTO -> detect
        if (selected === 'AUTO') {
          const country = await detectCountry();
          if (country && countryToCurrency[country]) {
            targetCurrency = countryToCurrency[country];
            status.textContent = `Detected ${country} ‚Äî showing prices in ${targetCurrency}`;
          } else {
            // default fallback
            targetCurrency = 'KES';
            status.textContent = 'Country not detected or unsupported ‚Äî showing KSH';
          }
        } else {
          // user selected specific country code
          targetCurrency = countryToCurrency[selected] || 'KES';
          status.textContent = `Showing prices in ${targetCurrency}`;
        }

        // fetch rates (unless target is KES)
        if (targetCurrency !== 'KES') {
          const ok = await fetchRates();
          if (ok && rates) {
            // Note: rates[from KES] => e.g. rates['USD'] = 0.0075 (1 KES = 0.0075 USD)
            // For conversion we want: price_in_target = price_in_ksh * rates[target]
            // So we pass targetCurrency directly
            setPriceDisplays(targetCurrency);
          } else {
            // failed -> show KES
            setPriceDisplays('KES');
          }
        } else {
          setPriceDisplays('KES');
        }

        detecting = false;
      }

      // initial flow
      (async function init(){
        select.value = 'AUTO';
        // init with KES (fast)
        setPriceDisplays('KES');
        // fire detect + rates
        await updatePricingFlow('AUTO');
      })();

      // manual override
      select.addEventListener('change', function(){
        const val = select.value;
        updatePricingFlow(val);
      });

      // expose for debugging
      window._guruPricing = { set: updatePricingFlow, rates };
    })();
  </script>

  <!-- keep your existing main script for audio and year -->
  <script src="script.js"></script>

</body>
</html>
